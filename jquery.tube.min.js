/*! jquery.tube.js 0.0.1 | https://github.com/inukshuk/jquery.tube.js */
(function(a,b,c,d,e){"use strict";var f=function(b){this.id=b.id.$t.match(/(\/[^\/]*)$/)[1],this.title=b.title.$t,this.description=b.media$group.media$description.$t,this.thumbnails=a.map(b.media$group.media$thumbnails,function(a){if(a.url)return a.url})};f.constants={},f.prototype.html=function(){};var g=function(b){this.videos=[],this.options=a.extend({},g.defaults,b)};g.constants={api:"//gdata.youtube.com/feeds/api/"},g.defaults={player:"#player",order:"published",author:!1,version:2,format:5,limit:!1,key:!1},g.parameters={q:"query","max-results":"limit",key:"key",format:"format",orderby:"order",author:"author",version:"v"},g.serialize=function(b){var c;switch(typeof b){case"string":c=encodeURI(b);break;case"object":b===null?c="":c=a.map(b,function(a,b){if(a)return[encodeURI(b),encodeURI(a)].join("=")}).join("&");break;default:c=""}return c},g.prototype.load=function(b){var c=this,d=0;return a.getJSON(this.request(),function(e){d=e.feed.entry.length,c.videos=a.map(e.feed.entry,function(a){return{title:a.title.$t,description:a.media$group.media$description.$t,id:a.id.$t.replace("http://gdata.youtube.com/feeds/api/videos/","")}}),b&&a.isFunction(b)&&b.apply(c,d)}),this},g.prototype.parameters=function(){var b=this,c={};return a.each(g.parameters,function(a,d){b.options[d]&&(c[a]=b.options[d])}),c.alt="json-in-script",c.callback="?",c},g.prototype.request=function(b){var c=g.constants.api;return a.extend(this.options,b||{}),this.options.playlist?c+="playlists/"+this.options.playlist:c+="videos",[c,"?",g.serialize(this.parameters())].join("")},g.prototype.authenticate=function(){},g.prototype.html=function(){var b=a.map(this.videos,function(a){return"<li>"+a.html()+"</li>"});return"<ul>"+b.join("")+"</ul>"};var h=function(a){this.options=a};h.ready=!1,h.load=function(b){if(!h.ready){h.callback=b;var d=c.createElement("script");return d.src=a.tube.constants.api,a("script:first").before(d),!0}return!1},String.prototype.supplant||(String.prototype.supplant=function(a){return this.replace(/\{([^{}]*)\}/g,function(b,c){var d=a[c];return typeof d=="string"||typeof d=="number"?d:b})});var i={load:h.load,ready:h.ready};a.fn.tube=function(a){var b,c;return this.length&&(typeof a=="string"?c={query:a}:c=a,b=new g(c),b.load(),this.first().data("tube",b)),this},a.tube=function(b){var c=i[b];return a.isFunction(c)?c.call():c},a.tube.constants=g.constants,a.tube.defaults=g.defaults,b.onYouTubePlayerAPIReady=function(){h.ready=!0,console.log("player API loaded")}})(jQuery,window,window.document,"0.0.1")
